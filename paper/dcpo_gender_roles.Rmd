---
output: 
  pdf_document:
    citation_package: natbib
    keep_tex: true
    fig_caption: true
    latex_engine: pdflatex
    template: svm-latex-ms2.tex
title: "Public Gender Egalitarianism: A Dataset of Dynamic Comparative Public Opinion Toward Egalitarian Gender Roles in the Public Sphere"
thanks: "Corresponding author: [frederick-solt@uiowa.edu](mailto:frederick-solt@uiowa.edu).  Current version: `r format(Sys.time(), '%B %d, %Y')`."
author:

abstract: ""
keywords: "gender inequality, public opinion, measurement"
date: "`r format(Sys.time(), '%B %d, %Y')`"
fontsize: 11pt
spacing: double
bibliography: \dummy{`r file.path(getwd(), list.files(getwd(), "s.bib$", recursive = TRUE))`}
# csl: https://raw.githubusercontent.com/citation-style-language/styles/master/american-political-science-association.csl
biblio-style: apsr
citecolor: black
linkcolor: black
endnote: no
header-includes:
      - \usepackage{array}
      - \usepackage{caption}
      - \usepackage{graphicx}
      - \usepackage{siunitx}
      - \usepackage{colortbl}
      - \usepackage{multirow}
      - \usepackage{hhline}
      - \usepackage{calc}
      - \usepackage{tabularx}
      - \usepackage{threeparttable}
      - \usepackage{wrapfig}
---

```{r setup, include=FALSE}
options(tinytex.verbose = TRUE)

knitr::opts_chunk$set(cache = TRUE, echo = FALSE, message = FALSE, warning = FALSE,
                      fig.width=7, fig.height=2.5)

# If `DCPOtools` is not yet installed:
# remotes::install_github("fsolt/DCPOtools")

library(DCPOtools)
library(DCPO)
library(tidyverse)
library(countrycode)
library(patchwork)
library(rsdmx)

set.seed(324)
```


# Introduction

<!-- Gender egalitarian attitude has been grown over the decades not only in developed countries but also in developing societies [@boehnke2011gender]. -->
<!-- With the affluent variance in the gender egalitarian attitude around the world, scholars propose innovative research questions about the influence of gender egalitarian attitudes and its determinants. -->
<!-- For example, the association between gender egalitarian attitudes and women's political behavior [@krauss1974political], gender inequalities [@bianchi2012housework], women's descriptive representation in parliaments [@paxton2003women] have been examined. -->
<!-- However, the lack of cross-national time-series index prevents us from unveiling the cause and effect of gender egalitarian attitudes. -->
<!-- Very few cross-national time-series measures of gender egalitarianism exist and there is no consensus on the measures. -->
<!-- Even though a gender egalitarian index developed by @mcdaniel2008measuring exists, it only deals with limited number of countries (n=38) and with the fourth wave of World Value Survey (WVS) conducted between 1999 and 2004. -->


<!-- To overcome this limitation, we develop a comparable cross-national over time measure about gender egalitarian view in the public sector through the DCPO package for R [@Solt2020a].  -->
<!-- Our new index is based on data from 62 survey datasets from 1972 to 2020, which includes 224,640 observations.  -->
<!-- The newly developed gender egalitarian index provides opportunities for scholars to evaluate the generalizability of existing theories with large-N analysis, test the cause and effect of gender egalitarian attitudes, and build new theories with the preliminary statistical analysis. -->
<!-- The index provides an opportunity to descriptively examine how the attitudes have been changed over decades and why there are variations among countries with different political institutions, culture, religion, and other country specific factors. -->
<!-- We also can test the long-lasting question suggested by @krauss1974political about whether the differences in political behavior such as protests, voting, political volunteerism, and feminist movement of men and women are attributed to biological differences or public opinion on the gender role. -->
<!-- Moreover, the index makes it possible to unveil the relationship between gender egalitarianism and women's mobilization and representation [@erickson2002gender; @erickson2002gender; @klein2013gender; @paxton1997women]. -->
<!-- Furthermore, by measuring cross-national time-variant attitudes toward gender egalitarianism, our index positions researchers to ask questions about how public opinion relates to the macrolevel processes of gender, such as the relationship between public opinion about gender roles and policy decisions [@stimson1995dynamic; @lax2009gay; @Wwlezien2017public], public opinion and political institutions [@bartels2009explaining; @grieco2011let; @nir2015institutions], and the public opinion and the makeup of national militaries [@brooks2011war; @eichenberg2016gender; @lizotte2017gender]. -->


<!-- This article proceeds with the following order.  -->
<!-- First, we discuss multi-dimensionality in egalitarian gender role and the reasons why we focus on the public sector. -->
<!-- Next, we illustrate the data source we used to build our index. -->
<!-- Then, the estimates of egalitarian gender role about 120 countries from 1972 to 2020 is introduced. -->
<!-- Lastly, we provide examples of how the new index about egalitarian gender role can be used and conclude.     -->
<!-- Gender egalitarianism does not have only one dimension but a multi-dimension. -->
<!-- Generating a measure of egalitarian gender roles without the classification may cause multidimensionality problem since people might have different opinions about gender roles by the dimensions. -->
<!-- For instance, some people have a more egalitarian veiw about the gender role in public sector rather than in private sector, while others do not. -->
<!-- To be specific, some might think that men and women should be treated and promoted equally at work, but that women should be in charge of housework. -->
<!-- Also, others may argue that both men and women can succeed as politicians, while saying that women are responsible for parenting. -->
<!-- The multi-dimensionality problem is relatively not salient if people in a society have an egalitarian view of all dimensions. -->
<!-- However, if we disregard this kind of multi-dimensionality given that there are some variations of gender egalitarain opinions by dimensions, we will not be able to measure gender egalitarianism properly in the various dimensions that people have. -->

# Focusing on Public Opinion Toward Gender Equality in the Public Sphere

```{r dcpo_input_raw, include=FALSE, cache.extra = tools::md5sum(here::here("data-raw", "surveys_egr.csv"))}
surveys_egr <- read_csv(here::here("data-raw", "surveys_egr_classification.csv"),
                        col_types = "ccccnnn")

surveys_egr_public <- surveys_egr %>% 
  filter(agreed == 1)

surveys_egr_private <- surveys_egr %>% 
  filter(agreed == 2)

surveys_egr_balance <- surveys_egr %>% 
  filter(agreed == 3)

surveys_egr_dominance <- surveys_egr %>% 
  filter(agreed == 4)

dcpo_input_raw_public <- DCPOtools::dcpo_setup(vars = surveys_egr_public,
                                               datapath = here::here("..",
                                                                     "data", "dcpo_surveys"),
                                               file = here::here("data",
                                                                 "dcpo_input_raw_public.csv"))

dcpo_input_raw_private <- DCPOtools::dcpo_setup(vars = surveys_egr_private,
                                               datapath = here::here("..",
                                                                     "data", "dcpo_surveys"),
                                               file = here::here("data",
                                                                 "dcpo_input_raw_private.csv"))

dcpo_input_raw_balance <- DCPOtools::dcpo_setup(vars = surveys_egr_balance,
                                               datapath = here::here("..",
                                                                     "data", "dcpo_surveys"),
                                               file = here::here("data",
                                                                 "dcpo_input_raw_balance.csv"))

dcpo_input_raw_dominance <- DCPOtools::dcpo_setup(vars = surveys_egr_dominance,
                                               datapath = here::here("..",
                                                                     "data", "dcpo_surveys"),
                                               file = here::here("data",
                                                                 "dcpo_input_raw_dominance.csv"))
```

```{r egr_summary_stats}
dcpo_input_raw_public <- read_csv(here::here("data", "dcpo_input_raw_public.csv"),
                                  col_types = "cdcddcd")

process_dcpo_input_raw <- function(dcpo_input_raw_df) {
  dcpo_input_raw_df %>% 
  with_min_yrs(2) %>% 
  with_min_cy(5) %>% 
  group_by(country) %>% 
  mutate(cc_rank = n()) %>% 
  ungroup() %>% 
  arrange(-cc_rank)
} 

dcpo_input_raw_public1 <- process_dcpo_input_raw(dcpo_input_raw_public)
dcpo_input_raw_private1 <- process_dcpo_input_raw(dcpo_input_raw_private)
dcpo_input_raw_balance1 <- process_dcpo_input_raw(dcpo_input_raw_balance)
dcpo_input_raw_dominance1 <- process_dcpo_input_raw(dcpo_input_raw_dominance)

n_surveys <- surveys_egr %>%
  distinct(survey) %>% 
  nrow()

n_items <- dcpo_input_raw_public1 %>%
  distinct(item) %>% 
  nrow()

n_countries <- dcpo_input_raw_public1 %>%
  distinct(country) %>% 
  nrow()

n_cy <- dcpo_input_raw_public1 %>%
  distinct(country, year) %>% 
  nrow() %>% 
  scales::comma()

n_years <- as.integer(summary(dcpo_input_raw_public1$year)[6]-summary(dcpo_input_raw_public1$year)[1])

spanned_cy <- dcpo_input_raw_public1 %>% 
  group_by(country) %>% 
  summarize(years = max(year) - min(year) + 1) %>% 
  summarize(n = sum(years)) %>% 
  pull(n) %>% 
  scales::comma()

total_cy <- {n_countries * n_years} %>% 
  scales::comma()

year_range <- paste("from",
                    summary(dcpo_input_raw_public1$year)[1],
                    "to",
                    summary(dcpo_input_raw_public1$year)[6])

n_cyi <- dcpo_input_raw_public1 %>% 
  distinct(country, year, item) %>% 
  nrow() %>% 
  scales::comma()

back_to_numeric <- function(string_number) {
  string_number %>% 
    str_replace(",", "") %>% 
    as.numeric()
}
```

We classified the available survey items on gender egalitarian attitudes into four categories.
The first of these categories consists of questions asking respondents' views of gender equality in the traditionally masculine public sphere of education, paid work, and politics.
The second category, in turn, encompasses questions focusing on gender equality in the traditionally feminine private sphere of housework and childcare.
A third category we identified comprises questions asking respondents how women should balance opportunities in the public sphere with their traditional duties in the private sphere, such as whether mothers in the workforce can have similarly warm relationships with their children as mothers who are not; it is telling, though not surprising, that the complementary set of questions, on how _men_ should balance responsibilities in the private sphere with their traditional roles in the public sphere, is only rarely included in surveys.^[
One laudable example of this mostly unasked sort of question, apparently first included in Australia's 1989 National Social Science Survey and slowly becoming more common, is the item querying respondents the extent to which they agree with the statement, "Family life often suffers when men concentrate too much on their work."]
The fourth and final category includes respondents' views on various forms of women's domination by men, from whether wives should adopt their husbands' surnames through the recognition that various forms of sexual harassment are not "flattering" to the justifiability of intimate partner violence committed by husbands.

To avoid any potential multidimensionality in the Public Gender Egalitarianism data, we include only survey items corresponding to the first category, gender egalitarianism in the public sphere.^[
Items that fell into both the first category and another, such as the `tradroles` questions---those with stems of the form "A man's job is to earn money; a woman's job is to look after the home and family"---which by explicitly counterposing the traditional gender roles suggests women unlike men should not earn money in the public sphere (while also suggesting that men unlike women should not look after home and family in the private sphere) were included in the PGE source data.
The complete list of gender egalitarianism items is included in the Appendix.]
Thus, the "Public" in the name of the dataset does double duty, referring both to the fact that it measures the _public's_ attitudes on gender equality and to its attitudes specifically on this _public_ aspect of gender egalitarianism.
In all, we identified `r n_items` of these survey items that were asked in no fewer than five country-years in countries surveyed at least twice; these items were drawn from `r n_surveys` different survey datasets.
We describe these source data in detail in the next section.


# Examining the Source Data on Public Gender Egalitarianism

Together, the survey items in the source data were asked in `r n_countries` different countries in at least two time points over `r n_years` years, `r year_range`, yielding a total of `r n_cyi` country-year-item observations.
Considering that observations for every year in each country surveyed would number `r total_cy`, a complete set of country-year-items would encompass `r {n_countries * n_years * n_items} %>% scales::comma()` observations.
Viewed from this perspective of complete data, the available data can be seen to be very, very sparse.
From a more optimistic standpoint, we note there there are `r n_cy` country-years in which we have at least _some_ information about the public gender egalitarianism of the population, that is, some `r {back_to_numeric(n_cy)/back_to_numeric(spanned_cy) * 100} %>% round()`% of the `r spanned_cy` country-years spanned by the data we collected.
But there can be no gainsaying that the many different survey items employed renders these data difficult to use together.

```{r item_and_country_plots, fig.height = 3.5, fig.cap = "Items, Countries, and Years with the Most Observations in the PGE Source Data \\label{item_country_plots}"}
items_plot <- dcpo_input_raw_public1 %>%
  distinct(country, year, item) %>%
  count(item) %>%
  arrange(desc(n)) %>% 
  head(12) %>% 
  ggplot(aes(forcats::fct_reorder(item, n, .desc = TRUE), n)) +
  geom_bar(stat = "identity") +
  theme_bw() +
  theme(axis.title.x = element_blank(),
        axis.text.x  = element_text(angle = 90, vjust = .45, hjust = .95),
        axis.title.y = element_text(size = 9),
        plot.title = element_text(hjust = 0.5, size = 11)) +
  ylab("Country-Years\nObserved") +
  ggtitle("Items")

polileader4_cy <- dcpo_input_raw_public1 %>% filter(item == "polileader4") %>% distinct(country, year) %>% nrow()

polileader4_surveys <- dcpo_input_raw_public1 %>% filter(item == "polileader4") %>% distinct(survey) %>% pull(survey)

countries_plot <- dcpo_input_raw_public1 %>%
  mutate(country = if_else(stringr::str_detect(country, "United"),
                           stringr::str_replace(country, "((.).*) ((.).*)", "\\2.\\4."),
                           country)) %>% 
  distinct(country, year, item) %>% 
  count(country) %>%
  arrange(desc(n)) %>% 
  head(12) %>% 
  ggplot(aes(forcats::fct_reorder(country, n, .desc = TRUE), n)) +
  geom_bar(stat = "identity") +
  theme_bw() +
  theme(axis.title.x = element_blank(),
        axis.text.x  = element_text(angle = 90, vjust = .45, hjust = .95),
        axis.title.y = element_text(size = 9),
        plot.title = element_text(hjust = 0.5, size = 11)) +
  ylab("Year-Items\nObserved") +
  ggtitle("Countries")

cby_plot <- dcpo_input_raw_public1 %>%
  mutate(country = if_else(stringr::str_detect(country, "United"),
                           stringr::str_replace(country, "((.).*) ((.).*)", "\\2.\\4."),
                           country),
         country = stringr::str_replace(country, "South", "S.")) %>% 
  distinct(country, year) %>%
  count(country) %>% 
  arrange(desc(n)) %>% 
  head(12) %>% 
  ggplot(aes(forcats::fct_reorder(country, n, .desc = TRUE), n)) +
  geom_bar(stat = "identity") +
  theme_bw() +
  theme(axis.title.x = element_blank(),
        axis.text.x  = element_text(angle = 90, vjust = .45, hjust = .95),
        axis.title.y = element_text(size = 9),
        plot.title = element_text(hjust = 0.5, size = 11)) +
  ylab("Years\nObserved") +
  ggtitle("Countries")


ybc_plot <- dcpo_input_raw_public1 %>%
  distinct(country, year) %>%
  count(year, name = "nn") %>%
  ggplot(aes(year, nn)) +
  geom_bar(stat = "identity") +
  theme_bw() +
  theme(axis.title.x = element_blank(),
        axis.text.x  = element_text(angle = 90, vjust = .45, hjust = .95),
        axis.title.y = element_text(size = 9),
        plot.title = element_text(hjust = 0.5, size = 11)) +
  ylab("Countries\nObserved") +
  ggtitle("Years")

us_obs <- dcpo_input_raw_public1 %>% 
  distinct(country, year, item) %>%
  count(country) %>%
  filter(country == "United States") %>%
  pull(n)

others <- dcpo_input_raw_public1 %>%
  distinct(country, year, item) %>%
  count(country) %>%
  arrange(desc(n)) %>%
  slice(2:5) %>%
  pull(country) %>% 
  paste(collapse = ", ") %>% 
  str_replace(", (\\w+)$", ", and \\1")

data_poorest <- dcpo_input_raw_public1 %>%
  distinct(country, year, item) %>%
  count(country) %>%
  arrange(n) %>%
  filter(n == 2) %>%
  pull(country) %>% 
  paste(collapse = ", ") %>% 
  str_replace(", (\\w+)$", ", and \\1")

wordify_numeral <- function(x) setNames(c("one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", " seventeen", "eighteen", "nineteen"), 1:19)[x]

n_data_poorest <- {data_poorest %>%
    str_split(",") %>% 
    first()} %>% 
  length() %>% 
  wordify_numeral()

(items_plot + countries_plot) / (cby_plot + ybc_plot)
```

The left panel of Figure&nbsp;\ref{item_country_plots} displays in how many country-years each of the twelve most-commonly asked survey items are available.
The `polileader4` item, which asks respondents whether they strongly agree, agree, disagree, or strongly disagree with the statement "On the whole, men make better political leaders than women do," was the most frequently asked question in the data we collected.
Employed by the Americas Barometer, the Arab Barometer, the Eurobarometer, the Latinobarómetro, the Pew Research Center, and the World Values Survey, this question was asked in a total of `r polileader4_cy` different country-years.
That this constitutes only `r {polileader4_cy*100/(spanned_cy %>% str_replace(",", "") %>% as.numeric())} %>% round()`% of the country-years spanned by our data---and remember, `polileader4` is the _most common_ survey item---again underscores just how sparse and incomparable the available public opinion data is on this topic.

Which countries are the most data-rich?
The right panel of Figure&nbsp;\ref{item_country_plots} shows the dozen countries with the highest count of country-year-item observations.
The United States, with `r us_obs` observations, is far and away the best represented country in the source data, followed by `r others`.
At the other end of the spectrum, `r n_data_poorest` countries---`r data_poorest`---have only the minimum two observations required to be included in the source dataset at all.

```{r dcpo_input_public}
dcpo_input_public <- DCPOtools::format_dcpo(dcpo_input_raw_public1,
                                            scale_q = "polileader4",
                                            scale_cp = 2)
save(dcpo_input_public, file = here::here("data", "dcpo_input_public.rda"))
```

# Estimating Public Gender Egalitarianism

There has been a recent blossoming of scholarship developing latent variable models of public opinion based on cross-national survey data [see @Claassen2019; @Caughey2019; @McGann2019; @Kolczynska2020].
To estimate public gender egalitarianism across countries and over time, we draw on the latest of these methods that is appropriate for data that is not only incomparable but also sparse, the Dynamic Comparative Public Opinion  (DCPO) model presented in @Solt2020c.^[
@Solt2020 demonstrates that the DCPO model provides a better fit to survey data than the models put forward by @Claassen2019 or @Caughey2019.
The @McGann2019 model depends on dense survey data unlike the sparse data on public gender egalitarianism described in the preceding section.
@Kolczynska2020 is the very most recent of the five works and builds on each of the others, but the MRP approach developed in that piece is suitable only when the available survey data are dense and ancillary data on population characteristics are also available, so it is similarly inappropriate to this application.
]

The DCPO model is a population-level two-parameter ordinal logistic item response theory (IRT) model with country-specific item bias.
That is, $\eta_{ktqr}$, the expected probability that a random person in country $k$ at time $t$ answers question $q$ with a response at least as positive as response $r$, is estimated as varying with the mean and standard deviation of the unbounded latent trait of public opinion, $\bar{\theta'}_{kt}$ and $\sigma_{kt}$; with the dispersion, $\alpha_{q}$, of the question and the difficulty, $\beta_{qr}$, of the question's response category; as well as with a term to capture how responses to particular questions in particular questions may be biased, $\delta_{kq}$: $\eta_{ktqr} = \textrm{logit}^{-1}(\frac{\bar{\theta'}_{kt} - (\beta_{qr} + \delta_{kq})}{\sqrt{\alpha_{q}^2 + (1.7*\sigma_{kt})^2}}) \label{eq:dcpo}$.
A beta-binomial distribution is used to model the observed survey data given $\eta_{ktqr}$, random-walk priors are used to account for the dynamics in $\bar{\theta'}_{kt}$ and $\sigma_{kt}$, and weakly informative priors are placed on the other parameters.
Finally, the logistic function is used to transform $\bar{\theta'}_{kt}$ to the unit interval and so give the bounded mean of latent public opinion, $\bar{\theta}_{kt}$, which is our parameter of interest here [see @Solt2020c, 3-8].

```{r dcpo, eval=FALSE}
iter <- 4000

dcpo_input <- dcpo_input_public

dcpo_output <- dcpo(dcpo_input,
                    iter = iter,
                    chains = 4,
                    thin = iter/500, # this yields 250 draws per chain, 1000 draws total
                    pars = c("sd_delta","sd_theta_evolve", "sd_sigma_evolve", "sigma","phi","beta","alpha","delta","theta","y_r_pred","log_lik"))
```

```{r dcpo_results}
load(here::here("data", "polileader4_2_4k_11-27.rda"))

save(dcpo_input, file = here::here("data", "dcpo_input.rda"))

save(dcpo_output, file = here::here("data", "dcpo_output.rda"))
```

```{r dcpo_results_summary}
load(here::here("data", "dcpo_input.rda"))
load(here::here("data", "dcpo_output.rda"))

theta_results <- DCPO::summarize_dcpo_results(dcpo_input,
                                              dcpo_output,
                                              "theta")

res_cy <- nrow(theta_results) %>% 
  scales::comma()

res_c <- theta_results %>% 
  pull(country) %>% 
  unique() %>% 
  length()
```

We used the `DCPO` package for R [@Solt2020a] to estimate this model on the public gender egalitarianism source data described above.
The result is estimates, in all `r res_cy` country-years spanned by the source data, of mean public gender egalitarianism, what we call PGE scores.
Figure&nbsp;\ref{cs_mry} displays the most recent available PGE score for each of the `r res_c` countries in the dataset.


```{r cs_plot, fig.cap="PGE Scores, Most Recent Available Year \\label{cs_mry}", fig.height=4}


n_panes <- 3

p1_data <- theta_results %>%
  group_by(country) %>%
  top_n(1, year) %>%
  ungroup() %>%
  arrange(mean) %>%
  transmute(country_year = paste0(country, " (", year, ")") %>% 
              str_replace("’", "'"),
            estimate = mean,
            conf.high = `90%`,
            conf.low = `10%`,
            pane = n_panes - (ntile(mean, n_panes) - 1),
            ranked = as.factor(ceiling(row_number())))

p_theta <- ggplot(p1_data,
                  aes(x = estimate, y = ranked)) +
  geom_segment(aes(x = conf.low, xend = conf.high,
                   y = ranked, yend = ranked),
               na.rm = TRUE,
               alpha = .2) +
  geom_point(fill = "black", shape = 21, size = .5, na.rm = TRUE) +
  theme_bw() + theme(legend.position="none",
                     axis.text.x  = element_text(size=7,
                                                 angle = 90,
                                                 vjust = .45,
                                                 hjust = .95),
                     axis.text.y  = element_text(size=7),
                     axis.title = element_blank(),
                     strip.background = element_blank(), 
                     strip.text = element_blank(),
                     panel.grid.major = element_line(size = .3),
                     panel.grid.minor = element_line(size = .15)) +
  scale_y_discrete(breaks = p1_data$ranked, labels=p1_data$country_year) +
  coord_cartesian(xlim=c(0, 1)) +
  facet_wrap(vars(pane), scales = "free", nrow = 1)


p_theta +
  plot_annotation(caption = "Note: Gray whiskers represent 80% credible intervals.")

```

The Scandinavian countries, France, and Spain are at the top of this list, followed by Puerto Rico, which has had women of both of its major parties serve as chief executive and as recently as 2020 had a woman from each party holding the two most prominent elected offices on the island.
The latest scores for Egypt, Yemen, Pakistan, the Palestinian Territories, and Burkina Faso have them as the places where public opinion is least favorable to gender equality in the public sphere.

# Validating Public Gender Egalitarianism
We consider now the validity of the PGE scores.
Like @Caughey2019 [684-685], we provide evidence of our measure's validity with  convergent validation and construct validation.

```{r extract_res}
dat <- dcpo_input$data

qcodes <- dat %>%
  dplyr::group_by(question) %>%
  dplyr::summarize(qq = first(qq) %>%
                     as.numeric())

kcodes <- dat %>%
  dplyr::group_by(country) %>%
  dplyr::summarize(kk = first(kk) %>%
                     as.numeric())

tcodes <- dat %>%
  dplyr::group_by(year) %>%
  dplyr::summarize(tt = first(tt))

ktcodes <- dat %>%
  dplyr::group_by(country) %>%
  dplyr::summarize(first_yr = min(year),
                   last_yr = max(year))

theta_res <- rstan::extract(dcpo_output, pars = "theta") %>%
        dplyr::first() %>%
        purrr::array_branch(1) %>%
        purrr::map(function(x) {
          tibble::as_tibble(x) %>%
          dplyr::mutate(tt = row_number()) %>%
            dplyr::left_join(tcodes, by = "tt") %>%
            tidyr::pivot_longer(cols = starts_with("V"),
                                names_to = "kk",
                                values_to = "pge_mean") %>%
            dplyr::mutate(year = if_else(tt == 1,
                                         year, min(year, na.rm = TRUE) + tt - 1),
                          kk = str_replace(kk, "V", "") %>% as.numeric()) %>%
            dplyr::left_join(kcodes, by = "kk") %>%
            dplyr::left_join(ktcodes, by = "country") %>%
            dplyr::filter(year >= first_yr & year <= last_yr) %>%
            dplyr::arrange(kk, tt) %>%
            dplyr::select(country, year, pge_mean)
        })

sigma_res <- rstan::extract(dcpo_output, pars = "sigma") %>%
        dplyr::first() %>%
        purrr::array_branch(1) %>%
        purrr::map(function(x) {
          tibble::as_tibble(x) %>%
          dplyr::mutate(tt = row_number()) %>%
            dplyr::left_join(tcodes, by = "tt") %>%
            tidyr::pivot_longer(cols = starts_with("V"),
                                names_to = "kk",
                                values_to = "pge_polarization") %>%
            dplyr::mutate(year = if_else(tt == 1,
                                         year, min(year, na.rm = TRUE) + tt - 1),
                          kk = str_replace(kk, "V", "") %>% as.numeric()) %>%
            dplyr::left_join(kcodes, by = "kk") %>%
            dplyr::left_join(ktcodes, by = "country") %>%
            dplyr::filter(year >= first_yr & year <= last_yr) %>%
            dplyr::arrange(kk, tt) %>%
            dplyr::select(country, year, pge_polarization)
        })

pge <- map2(theta_res, sigma_res, function(theta, sigma) {
  left_join(theta, sigma, by = c("country", "year"))
})

save(pge, file = here::here("data", "pge.rda"))
```

```{r convergent, fig.cap="Convergent Validation: Correlations Between PGE Scores and Individual PGE Source Data Survey Items \\label{conv_plot}", fig.height=4}

internal_dat <- dcpo_input$data %>% 
  filter(item == "polileader4 3 or higher") %>% 
  mutate(prop = 1 - y_r/n_r,
         se = sqrt((prop*(1-prop))/n),
         prop_90 = prop + qnorm(.9)*se,
         prop_10 = prop - qnorm(.9)*se) %>% 
  left_join(theta_results %>% select(-kk, -tt), by = c("country", "year"))

pge_polileader <- pge %>% 
  map(. %>% right_join(dcpo_input$data %>% 
                         filter(item == "polileader4 3 or higher") %>% 
                         rowwise() %>% 
                         transmute(country = country,
                                   year = year,
                                   prop = 1 - y_r/n_r,
                                   se = sqrt((prop*(1-prop))/n),
                                   polileader = rnorm(1, mean = prop, sd = se)), 
                       by = c("country", "year")))

internal_cor <- map(pge_polileader, function(x) with(x, cor(pge_mean, polileader))) %>% 
  unlist() %>% 
  mean() %>% 
  round(2) %>% 
  paste0("R = ", .)

internal_label <- tibble(mean = .78, prop = .99, label = internal_cor)

internal_plot <- internal_dat %>% 
  ggplot(aes(x = mean,
             y = prop * 100)) +
  geom_segment(aes(x = `10%`, xend = `90%`,
                   y = prop * 100, yend = prop * 100),
               na.rm = TRUE,
               alpha = .2) +
  geom_segment(aes(x = mean, xend = mean,
                   y = prop_90 * 100, yend = prop_10 * 100),
               na.rm = TRUE,
               alpha = .2) +
  geom_smooth(method = 'lm', se = FALSE) +
  theme_bw() +
  theme(legend.position="none",
        axis.text  = element_text(size=8),
        axis.title = element_text(size=9),
        plot.title = element_text(hjust = 0.5, size = 11)) +
  coord_cartesian(ylim=c(0,100)) +
  scale_x_continuous(breaks=seq(.1, .9, 0.2)) +
  labs(x = "PGE Score", 
       y = '% Agreeing That "On the Whole, Men\nMake Better Political Leaders than Women Do"') + 
  ggtitle("All Country-Years") +
  geom_label(data = internal_label, aes(label = label), size = 3)

## Cross-sectional
internal_poliequal <- dcpo_input$data %>% 
  filter(item == "poliequal3 2 or higher" & year == 2007) %>% 
  mutate(iso2c = countrycode::countrycode(country,
                             origin = "country.name",
                             destination = "iso2c"),
         prop = 1 - y_r/n_r,
         se = sqrt((prop*(1-prop))/n),
         prop_90 = prop + qnorm(.9)*se,
         prop_10 = prop - qnorm(.9)*se) %>% 
  left_join(theta_results %>% select(-kk, -tt), by = c("country", "year"))

pge_poliequal <- pge %>% 
  map(. %>% right_join(dcpo_input$data %>% 
                         filter(item == "poliequal3 2 or higher" & year == 2007) %>% 
                         rowwise() %>% 
                         transmute(country = country,
                                   year = year,
                                   prop = 1 - y_r/n_r,
                                   se = sqrt((prop*(1-prop))/n),
                                   poliequal = rnorm(1, mean = prop, sd = se)), 
                       by = c("country", "year")))

internal_cs_cor <- map(pge_poliequal, 
                       function(x) with(x, cor(pge_mean, poliequal))) %>% 
  unlist() %>% 
  mean() %>% 
  round(2) %>% 
  paste0("R = ", .)

internal_cs_label <- tibble(mean = .7, prop = .77, label = internal_cs_cor)

internal_cs_plot <- internal_poliequal %>% 
  ggplot(aes(x = mean,
             y = prop * 100)) +
  geom_segment(aes(x = `10%`, xend = `90%`,
                   y = prop * 100, yend = prop * 100),
               na.rm = TRUE,
               alpha = .2) +
  geom_segment(aes(x = mean, xend = mean,
                   y = prop_90 * 100, yend = prop_10 * 100),
               na.rm = TRUE,
               alpha = .2) +
  geom_text(aes(label = iso2c), size = 2) +
  geom_smooth(method = 'lm', se = FALSE) +
  theme_bw() +
  theme(legend.position="none",
        axis.text  = element_text(size=8),
        axis.title = element_text(size=9),
        plot.title = element_text(hjust = 0.5, size = 11)) +
  labs(x = "PGE Score", 
       y = '% Opining That "Men Generally Make\nBetter Political Leaders Than Women"') + 
  ggtitle("Pew Global Spring 2007") +
  geom_label(data = internal_cs_label, aes(label = label), size = 3)

# Longitudinal
internal_us <- dcpo_input$data %>% 
  filter(item == "emopoli2 2 or higher") %>% 
  mutate(prop = y_r/n_r,
         se = sqrt((prop*(1-prop))/n),
         prop_90 = prop + qnorm(.9)*se,
         prop_10 = prop - qnorm(.9)*se) %>% 
  right_join(theta_results %>% 
               select(-kk, -tt) %>%
               filter(country == "United States"),
             by = c("country", "year"))

pge_emopoli <- pge %>% 
  map(. %>% right_join(dcpo_input$data %>% 
                         filter(item == "emopoli2 2 or higher") %>% 
                         rowwise() %>% 
                         transmute(country = country,
                                   year = year,
                                   prop = y_r/n_r,
                                   se = sqrt((prop*(1-prop))/n),
                                   emopoli = rnorm(1, mean = prop, sd = se)), 
                       by = c("country", "year")))

internal_us_cor <- map(pge_emopoli, function(x) with(x, cor(pge_mean, emopoli))) %>% 
  unlist() %>% 
  mean() %>% 
  round(2) %>% 
  paste0("R = ", .)

internal_us_label <- tibble(year = 1980, mean = .82, label = internal_us_cor)

internal_us_plot <- internal_us %>% 
  ggplot(aes(x = year,
             y = mean)) +
  geom_line() +
  geom_ribbon(aes(ymin = `10%`,
                  ymax = `90%`,
                  linetype = NA),
               alpha = .2) +
  geom_point(aes(y = prop),
             fill = "black",
             shape = 21,
             size = .5,
             na.rm = TRUE) +
  geom_path(aes(y = prop),
            linetype = 3,
            na.rm = TRUE,
            alpha = .7) +
  geom_segment(aes(x = year, xend = year,
                   y = prop_90, yend = prop_10),
               na.rm = TRUE,
               alpha = .2) +
  annotate("text", x = 1979, y = .72, size = 2,
           label = 'emopoli2,\nU.S. GSS') +
  annotate("text", x = 2012, y = .60, size = 2,
           label = "PGE Mean") +
  labs(x = "Year", 
       y = "Score") +
  theme_bw() +
  theme(legend.position="none",
        axis.text  = element_text(size=8),
        axis.title = element_text(size=9),
        plot.title = element_text(hjust = 0.5, size = 11)) +
  ggtitle("United States") +
  geom_label(data = internal_us_label, aes(label = label), size = 3)

internal_plot + internal_cs_plot + internal_us_plot +
  plot_annotation(caption = "Note: Gray whiskers and shading represent 80% credible intervals.")
```

Figure&nbsp;\ref{conv_plot} displays our demonstrations of convergent validation.
Convergent validation refers to showing that a measure is empirically associated with alternative indicators of the same concept [@Adcock2001, 540].
Here, we compare PGE scores to responses to individual survey items that were included in the source data, that is, we provide an "internal" validation test [see, e.g., @Caughey2019, 689; @Solt2020c, 10].
In the left panel, we examine the `polileader4` question mentioned above, the most common item in the source data across all country-years.
<!-- In the left panel, we examine the `polileader4` question mentioned above, the most common item in the source data across all country-years, combining for this purpose all those who agreed or strongly agreed that "on the whole, men make better political leaders than women." -->
Then, in the center panel, we look at the question that provides most data-rich cross-section, the `poliequal3` item in Pew Global's Spring 2007 survey.
<!-- Then, in the center panel, we look at the question that provides most data-rich cross-section: the `poliequal3` item in Pew Global's Spring 2007 survey that asked whether respondents felt "men generally make better political leaders than women," vice versa, or whether "in general, women and men make equally good political leaders." -->
Finally, in the right panel, to evaluate how well the PGE score captures change over time, we focus on the item with the largest number of observations for a single country, the `emopoli2` survey item, which asks whether respondents agreed or disagreed that "most men are better suited emotionally for politics than are most women." 
<!-- Finally, in the right panel, to evaluate how well the PGE score captures change over time, we focus on the `emopoli2` survey item, the item with the largest number of observations for a single country. -->
<!-- The U.S. General Social Survey asked this question 25 times from 1972 to 2016. -->
<!-- It asks whether respondents agreed or disagreed that "most men are better suited emotionally for politics than are most women"; to facilitate visual comparison of the longitudinal relationship, we plot the estimated population proportion that disagreed with the statement. -->
In every case, the correlations---estimated taking into account the uncertainty in the measures^[
The uncertainty in the PGE score and in the percentage in the population who would agree with the item does not substantially affect the correlation with the `polileader4` question, but failing to account for this uncertainty would overstate the correlation with the Pew `poliequal3` item, at $R =$ `r with(internal_poliequal, cor(prop, mean)) %>% round(2)`, and the U.S. GSS `emopoli2` item, at $R =$ `r with(internal_us, cor(prop, mean, use = "pairwise.complete.obs")) %>% round(2)`.
We take up the issue of the importance of taking uncertainty into account when working with the PGE data in a subsequent section.]---are in the expected direction and very strong.

```{r construct_validation_survey, fig.cap="Construct Validation: Correlations Between PGE Scores and Individual 'Balancing' Gender Egalitarianism Survey Items \\label{surv_const_plot}", fig.height=4}
dcpo_input_balance <- DCPOtools::format_dcpo(dcpo_input_raw_balance1,
                                            scale_q = "familywoman4",
                                            scale_cp = 2)

wantch <- dcpo_input_balance$data %>% 
  filter(item == "wantch4 3 or higher") %>% 
  mutate(iso2c = countrycode::countrycode(country,
                             origin = "country.name",
                             destination = "iso2c"),
         prop = 1 - y_r/n_r,
         se = sqrt((prop*(1-prop))/n),
         prop_90 = prop + qnorm(.9)*se,
         prop_10 = prop - qnorm(.9)*se) %>% 
  left_join(theta_results %>% select(-kk, -tt), by = c("country", "year"))

pge_wantch <- pge %>% 
  map(. %>% right_join(wantch %>% 
                         rowwise() %>% 
                         transmute(country = country,
                                   year = year,
                                   prop = 1 - y_r/n_r,
                                   se = sqrt((prop*(1-prop))/n),
                                   wantch = rnorm(1, mean = prop, sd = se)), 
                       by = c("country", "year")))

wantch_cor <- map(pge_wantch, function(x) 
  with(x, cor(pge_mean, wantch))) %>% 
  unlist() %>% 
  mean() %>% 
  round(2) %>% 
  paste0("R = ", .)

wantch_label <- tibble(mean = .76, prop = .97, label = wantch_cor)

wantch_plot <- wantch %>% 
  ggplot(aes(x = mean,
             y = prop * 100)) +
  geom_segment(aes(x = `10%`, xend = `90%`,
                   y = prop * 100, yend = prop * 100),
               na.rm = TRUE,
               alpha = .2) +
  geom_segment(aes(x = mean, xend = mean,
                   y = prop_90 * 100, yend = prop_10 * 100),
               na.rm = TRUE,
               alpha = .2) +
  geom_smooth(method = 'lm', se = FALSE) +
  theme_bw() +
  theme(legend.position="none",
        axis.text  = element_text(size=8),
        axis.title = element_text(size=9),
        plot.title = element_text(hjust = 0.5, size = 11)) +
  coord_cartesian(ylim=c(0,100)) +
  labs(x = "PGE Score", 
       y = '% Agreeing That "A Job is Alright But What\nMost Women Really Want is a Home and Children"') + 
  ggtitle("All Country-Years") +
  geom_label(data = wantch_label, aes(label = label), size = 3)

# cross-section
familywoman <- dcpo_input_balance$data %>% 
  filter(item == "familywoman4 3 or higher") %>% 
  mutate(iso2c = countrycode::countrycode(country,
                             origin = "country.name",
                             destination = "iso2c"),
         prop = 1 - y_r/n_r,
         se = sqrt((prop*(1-prop))/n),
         prop_90 = prop + qnorm(.9)*se,
         prop_10 = prop - qnorm(.9)*se) %>% 
  left_join(theta_results %>% select(-kk, -tt), by = c("country", "year"))

pge_familywoman <- pge %>% 
  map(. %>% right_join(familywoman %>% 
                         rowwise() %>% 
                         transmute(country = country,
                                   year = year,
                                   prop = 1 - y_r/n_r,
                                   se = sqrt((prop*(1-prop))/n),
                                   familywoman = rnorm(1, mean = prop, sd = se)), 
                       by = c("country", "year")))

familywoman_cor <- map(pge_familywoman, function(x) 
  with(x, cor(pge_mean, familywoman))) %>% 
  unlist() %>% 
  mean() %>% 
  round(2) %>% 
  paste0("R = ", .)

familywoman_label <- tibble(mean = .8, prop = .97, label = familywoman_cor)

familywoman_plot <- familywoman %>% 
  ggplot(aes(x = mean,
             y = prop * 100)) +
  geom_segment(aes(x = `10%`, xend = `90%`,
                   y = prop * 100, yend = prop * 100),
               na.rm = TRUE,
               alpha = .2) +
  geom_segment(aes(x = mean, xend = mean,
                   y = prop_90 * 100, yend = prop_10 * 100),
               na.rm = TRUE,
               alpha = .2) +
  geom_text(aes(label = iso2c), size = 2) +
  geom_smooth(method = 'lm', se = FALSE) +
  theme_bw() +
  theme(legend.position="none",
        axis.text  = element_text(size=8),
        axis.title = element_text(size=9),
        plot.title = element_text(hjust = 0.5, size = 11)) +
  coord_cartesian(ylim=c(0,100)) +
  labs(x = "PGE Score", 
       y = '% Agreeing That "The Most Important Role of a\nWoman is to Take Care of Her Home and Family"') + 
  ggtitle("Eurobarometer 87.4") +
  geom_label(data = familywoman_label, aes(label = label), size = 3)

# time series
psw_de <- dcpo_input_balance$data %>% 
  filter(item == "preschoolwork4 3 or higher" & country == "Germany") %>% 
  mutate(prop = y_r/n_r,
         se = sqrt((prop*(1-prop))/n),
         prop_90 = prop + qnorm(.9)*se,
         prop_10 = prop - qnorm(.9)*se) %>% 
  right_join(theta_results %>% 
               select(-kk, -tt) %>%
               filter(country == "Germany"),
             by = c("country", "year"))

pge_de <- pge %>% 
  map(. %>% right_join(psw_de %>% 
                         rowwise() %>% 
                         transmute(country = country,
                                   year = year,
                                   prop = y_r/n_r,
                                   se = sqrt((prop*(1-prop))/n),
                                   var = rnorm(1, mean = prop, sd = se)), 
                       by = c("country", "year")))

psw_de_cor <- map(pge_de, function(x) 
  with(x, cor(pge_mean, var, use = "pairwise.complete.obs"))) %>% 
  unlist() %>% 
  mean() %>% 
  round(2) %>% 
  paste0("R = ", .)

psw_de_label <- tibble(year = 1990, mean = .8, label = psw_de_cor)

psw_de_plot <- psw_de %>% 
  ggplot(aes(x = year,
             y = mean)) +
  geom_line() +
  geom_ribbon(aes(ymin = `10%`,
                  ymax = `90%`,
                  linetype = NA),
               alpha = .2) +
  geom_point(aes(y = prop),
             fill = "black",
             shape = 21,
             size = .5,
             na.rm = TRUE) +
  geom_path(aes(y = prop),
            linetype = 3,
            na.rm = TRUE,
            alpha = .7) +
  geom_segment(aes(x = year, xend = year,
                   y = prop_90, yend = prop_10),
               na.rm = TRUE,
               alpha = .2) +
  annotate("text", x = 2010, y = .30, size = 2,
           label = 'preschoolwork4,\nALLBUS, EVS, WVS') +
  annotate("text", x = 1986, y = .66, size = 2,
           label = "PGE Mean") +
  labs(x = "Year", 
       y = "Score") +
  theme_bw() +
  theme(legend.position="none",
        axis.text  = element_text(size=8),
        axis.title = element_text(size=9),
        plot.title = element_text(hjust = 0.5, size = 11)) +
  ggtitle("Germany") +
  geom_label(data = psw_de_label, aes(label = label), size = 3)


wantch_plot + familywoman_plot + psw_de_plot +
  plot_annotation(caption = "Note: Gray whiskers and shading represent 80% credible intervals.")
```

We move on, then, to construct validation, which refers to demonstrating, for some _other_ concept believed causally related to the concept a measure seeks to represent, that the measure is empirically associated with measures of that other concept [@Adcock2001, 542].
In Figure&nbsp;\ref{surv_const_plot}, we look to individual survey items from our third category of gender egalitarianism, that is, questions that ask how women should balance opportunities in the public sphere with their traditional duties in the private sphere.
Assuming that attitudes that women should prioritize housework and childcare over education, politics, and paid employment---or convictions that there will be negative consequences if they do not---will lead to less gender egalitarian opinions with regard to these latter, public-sphere activities, evidence for this theoretical relationship will provide construct validation for the PGE score.
Exemplars of such items across all available country-years ("a job is alright but what most women really want is a home and children" from the WVS and EVS), in cross-section ("the most important role of a woman is to take care of her home and family" from the Eurobarometer 87.4), and in time series ("a pre-school child is likely to suffer if his or her mother works" from the German ALLBUS, WVS, and EVS) all show strong correlations with the PGE scores.
<!-- Consider `wantch4`, an item depicted in the left pane asked by the World Values Survey and the European Values Survey, which asked respondents the extent to which they agree with the statement, "a job is alright but what most women really want is a home and children." -->
<!-- As agreement suggests that women do not truly care about opportunities in the workplace, those who do should be expected to be less likely to believe women should enjoy equal access to such opportunities which men implicitly value more. -->
<!-- Or, similarly, `familywoman4`, an item plotted in the center pane from Eurobarometer 87.4, which asked respondents the extent of their agreement with the statement, "the most important role of a woman is to take care of her home and family."  -->
<!-- Though not directly implying that women should not enjoy equal opportunities in education, politics, and the workplace, it may still be fairly surmised that those holding this position would consequently consider that, since opportunities beyond the home are of secondary importance for women, men should have priority.^[
One might argue that these two questions, particularly the latter, rather than tapping a distinct concept causally related to public gender egalitarianism are in fact tapping aspects of public gender egalitarianism itself. -->
<!-- (Indeed, the `tradroles` series of questions, which couple the `familywoman4` stem with the idea that the most important role of a man is to earn money---and so more explicitly indicates that the public sphere is appropriately segregated by gender---is included among the items used to estimate the PGE data.) -->
<!-- If these two questions are thought of as indicators of public gender egalitarianism, then, because they are not included in the PGE source data, these plots constitute not construct validation but rather "external" convergent validation [see, e.g., @Caughey2019, 689; @Solt2020c, 10]. -->
<!-- In either case, though, they provide evidence of the validity of the PGE scores.] -->
<!-- In a slightly different vein, `preschoolwork4`, included in the German ALLBUS, the World Values Survey, and the European Values Survey, asked respondents the extent to which they agreed that "a pre-school child is likely to suffer if his or her mother works;" we plot the time series of the proportion of the population of Germany estimated to disagree or disagree strongly with this statement in the right pane. -->
<!-- The belief that mothers working cause harm to their children should be expected to lead to disfavoring gender equality in workforce to avoid this purported negative consequence.  -->
<!-- With regard to all of these items, too, the correlations with the PGE scores are strong. -->


```{r cons_valid_plot, fig.cap="Construct Validation: Correlations Between PGE Scores and Indicators of Workplace Gender Equality \\label{construct_plot}", fig.height=4}

# https://genderstats.un.org/#/downloads
lfpr_un <- read_csv(here::here("data", "3b - Labour force participation rate for persons aged 15+  by sex_data.csv"), skip = 1, col_types = "ccdcdcdccccccdddcc") %>% 
  select(Country, Year, Sex, Value) %>% 
  pivot_wider(names_from = Sex,
              values_from = Value) %>% 
  transmute(country = countrycode::countrycode(Country, 
                                               origin = "country.name",
                                               destination = "country.name"),
            iso2c = countrycode::countrycode(country,
                                             origin = "country.name",
                                             destination = "iso2c"),
            year = Year,
            flfpr = Female,
            f2m_ratio = round(Female/Male*100, 2)) %>% 
  filter(!is.na(country) & !is.na(flfpr)) %>% 
  left_join(theta_results, by = c("country", "year")) %>% 
  filter(!is.na(mean))

pge_lfpr <- pge %>% 
  map(. %>% right_join(lfpr_un, 
                       by = c("country", "year")))

lfpr_cor <- map(pge_lfpr, function(x) {
  x %>% 
    filter(year == 2016) %>% 
    with(cor(pge_mean, f2m_ratio))
  }) %>% 
  unlist() %>% 
  mean() %>% 
  round(2) %>% 
  paste0("R = ", .)

lfpr_label <- tibble(mean = .15, f2m_ratio = 90, label = lfpr_cor)

# https://stats.oecd.org/index.aspx?queryid=54753
directors <- rsdmx::readSDMX("https://stats.oecd.org/restsdmx/sdmx.ashx/GetData/GENDER_EMP/.EMP11.WOMEN.TOTAL.2017/all?") %>% 
  as_tibble() %>% 
  transmute(country = countrycode::countrycode(COU, "iso3c", "country.name"),
            iso2c = countrycode::countrycode(country,
                                          origin = "country.name",
                                          destination = "iso2c"),
            year = as.numeric(TIME),
            directors = obsValue) %>% 
  filter(!is.na(country)) %>% 
  inner_join(theta_results, by = c("country", "year"))

directors_cor <- map(pge, function(x) {
  x %>% 
    inner_join(directors %>% select(country, year, directors),
               by = c("country", "year")) %>% 
    with(cor(pge_mean, directors))
}) %>% 
  unlist() %>% 
  mean() %>% 
  round(2) %>% 
  paste0("R = ", .)

directors_label <- tibble(mean = .37, directors = 40, label = directors_cor)

lfpr_plot <- ggplot(lfpr_un %>% filter(year==2016),
       aes(x = mean,
           y = f2m_ratio)) +
  geom_segment(aes(x = `10%`, xend = `90%`,
                   y = f2m_ratio, yend = f2m_ratio),
               na.rm = TRUE,
               alpha = .2) +
  geom_text(aes(label = iso2c), size = 2) +
  geom_smooth(method = 'lm', se = FALSE) +
  theme_bw() + theme(legend.position="none",
                     axis.text  = element_text(size=8),
                     axis.title = element_text(size=9)) +
  coord_cartesian(xlim=c(0, 1)) +
  labs(x = "Public Gender Egalitarianism, 2016", y = "Female to Male Labor Force Participation Ratio, 2016") +
  geom_label(data = lfpr_label, aes(label = label))

dir_plot <- ggplot(directors,
       aes(x = mean,
           y = directors)) +
  geom_segment(aes(x = `10%`, xend = `90%`,
                   y = directors, yend = directors),
               na.rm = TRUE,
               alpha = .2) +
  geom_text(aes(label = iso2c), size = 2) +
  geom_smooth(method = 'lm', se = FALSE) +
  theme_bw() + theme(legend.position="none",
                     axis.text  = element_text(size=8),
                     axis.title = element_text(size=9)) +
  coord_cartesian(xlim=c(.2, 1)) +
  labs(x = "Public Gender Egalitarianism, 2017", y = "% Women, Boards of Directors of the \n Largest Publicly Listed Companies, 2017") +
  geom_label(data = directors_label, aes(label = label))

lfpr_plot + dir_plot +
  plot_annotation(caption = "Note: Gray whiskers represent 80% credible intervals.")
```

Finally, Figure&nbsp;\ref{construct_plot} shows additional tests of construct validation.
As attitudes toward gender egalitarianism in the public sphere plausibly both cause and are caused by women's gains in the workplace, strong relationships between the PGE scores and measures of workplace gender equality provide construct validation for our measure.
In the left panel of Figure&nbsp;\ref{construct_plot}, we compare the PGE scores to the ratio of women's to men's labor force participation rates in `r nrow(lfpr_un %>% filter(year == 2016))` countries in 2016, drawing on data compiled by the Statistics Division of the UN Department of Economic and Social Affairs [-@UNDESA2020].
In the right panel, we plot the PGE scores against the percentage of women on the boards of directors of the largest publicly listed companies in `r nrow(directors)` countries in 2017 [see @OECD2020].
Both correlations are strong.
Together, this evidence of construct validation and convergent validation attests to the validity of the PGE scores as measures of public opinion towards gender equality in the public sphere.


# Using the Public Gender Egalitarianism Dataset
Version 1.0 of the PGE dataset includes PGE scores for `r pge[[1]] %>% distinct(country) %>% nrow()` countries for as many years as possible from 1972 to the present, a total of `r pge[[1]] %>% nrow()` country-years.
It can be accessed in two ways: via a user-friendly web application on the PGE website, which plots scores for as many as four countries for easy comparison of levels and trends, and via the Harvard Dataverse, where the entire dataset is available for download for use in statistical analysis.
We will revise and update the dataset as new survey data on public gender egalitarianism becomes available.

One aspect of latent-variable estimates of public opinion like the PGE dataset that is easy for researchers to overlook is the uncertainty in the estimates.
But neglecting to incorporate this uncertainty by using only the mean estimate for each country-year---that is, for example, the mean of the PGE scores---in an analysis can lead one to mistakenly conclude that the analysis supports the hypothesis [see @Tai2020] as well as to mistakenly conclude that it does _not_ support the hypothesis [see @Crabtree2015].
Therefore, taking the uncertainty in the PGE scores into account is crucial to reaching well-grounded conclusions.

The download includes pre-formatted data to facilitate incorporating the uncertainty in the PGE scores.
In R, the functions of the \texttt{purrr} package [@Henry2019, also included in the widely-used \texttt{tidyverse} package [@Wickham2017a]] make it entirely straightforward to incorporate the uncertainty of the PGE estimates.
In Stata, the \texttt{mi estimate:} command prefix originally developed for analyzing multiply imputed data can be used to automate the process of building uncertainty into nearly any analysis.
Step-by-step instructions on how to use these tools, complete with examples, are included in the data download.



\pagebreak
