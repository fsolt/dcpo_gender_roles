---
title: '[dcpo_gender_roles]: A Dataset of Dynamic Comparative Public Opinion Toward
  Egalitarian Gender Roles'
author: "null"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  word_document: default
  pdf_document:
    citation_package: natbib
    fig_caption: yes
    keep_tex: yes
    latex_engine: pdflatex
    template: svm-latex-ms2.tex
citecolor: black
biblio-style: apsr
endnote: no
fontsize: 11pt
header-includes:
- \usepackage{array}
- \usepackage{caption}
- \usepackage{graphicx}
- \usepackage{siunitx}
- \usepackage{colortbl}
- \usepackage{multirow}
- \usepackage{hhline}
- \usepackage{calc}
- \usepackage{tabularx}
- \usepackage{threeparttable}
- \usepackage{wrapfig}
keywords: ''
linkcolor: black
nocite: |2
  @Solt2020a
bibliography: \dummy{`r file.path(getwd(), list.files(getwd(), ".bib$", recursive
  = TRUE))`}
spacing: double
thanks: 'Corresponding author: [frederick-solt@uiowa.edu](mailto:frederick-solt@uiowa.edu).  Current
  version: `r format(Sys.time(), ''%B %d, %Y'')`.'
abstract: ''
---



```{r setup, include=FALSE}

options(tinytex.verbose = TRUE)



knitr::opts_chunk$set(cache = TRUE, echo = FALSE, fig.width=6.5, fig.height=2.5, cache.extra = tools::md5sum(here::here("data", "dcpo_input_raw.csv")))



# If `DCPOtools` is not yet installed:

# remotes::install_github("fsolt/DCPOtools")



library(DCPOtools)

library(DCPO)

library(tidyverse)



set.seed(324)

```

# Introduction

Gender egalitarian attitude has been grown over the decades not only in developed countries but also in developing societies [@boehnke2011gender]. With the affluent variance in the gender egalitarian attitude around the world, scholars propose innovative research questions about the influence of gender egalitarian attitudes and its determinants. For example, the association between gender egalitarian attitudes and women's political behavior [@krauss1974political], gender inequalities [@bianchi2012housework], women's descriptive representation in parliaments [@paxton2003women] have been examined. However, the lack of cross-national time-series index prevents us from unveiling the cause and effect of gender egalitarian attitudes. Very few cross-national time-series measures of gender egalitarianism exist and there is no consensus on the measures. Even though a gender egalitarian index developed by @mcdaniel2008measuring exists, it only deals with limited number of countries (n=38) and with the fourth wave of World Value Survey (WVS) conducted between 1999 and 2004.
 To overcome this limitation, we develop a comparable cross-national over time measure about gender egalitarian view through the DCPO package for R [@Solt2020a]. (Quick Review of our Index can be included).
 The newly developed gender egalitarian index enables scholars to evaluate the generalizability of existing theories with large-N analysis, test the cause and effect of gender egalitarian attitudes, and build new theories with the preliminary statistical analysis. The index provides an opportunity to descriptively examine how the attitudes have been changed over decades and why there are variations among countries with different political institutions, culture, religion, and other country specific factors. We also can test the long-lasting question suggested by @krauss1974political about whether the differences in political behavior such as protests, voting, political volunteerism, and feminist movement of men and women are attributed to biological differences or public opinion on the gender role. Moreover, the index makes it possible to unveil the relationship between gender egalitarianism and women's mobilization and representation [@erickson2002gender; @erickson2002gender; @klein2013gender; @paxton1997women]. Furthermore, by measuring cross-national time-variant attitudes toward gender egalitarianism, our index positions researchers to ask questions about how public opinion relates to the macrolevel processes of gender, such as the relationship between public opinion about gender roles and policy decisions [@stimson1995dynamic; @lax2009gay; @Wwlezien2017public], public opinion and political institutions [@bartels2009explaining; @grieco2011let; @nir2015institutions], and the public opinion and the makeup of national militaries [@brooks2011war; @eichenberg2016gender; @lizotte2017gender].
 This article proceeds with the following order. (Brief summaries about the rest of sections will be provided)
 






# The Source Data on Gender Egalitarian Attitudes



```{r dcpo_input_raw, include=FALSE, cache.extra = tools::md5sum(here::here("data-raw", "surveys_egr.csv"))}

surveys_egr <- read_csv(here::here("data-raw", "surveys_egr.csv"),

                        col_types = "cccc")



dcpo_input_raw <- DCPOtools::dcpo_setup(vars = surveys_egr,

                                        datapath = here::here("..", "data", "dcpo_surveys"),

                                        file = here::here("data", "dcpo_input_raw.csv"))

```



```{r egr_summary_stats}

dcpo_input_raw1 <- dcpo_input_raw %>% 

  with_min_yrs(2) %>% 

  with_min_cy(5) %>% 

  group_by(country) %>% 

  mutate(cc_rank = n()) %>% 

  ungroup() %>% 

  arrange(-cc_rank)



n_surveys <- surveys_egr %>%

  distinct(survey) %>% 

  nrow()



n_items <- dcpo_input_raw1 %>%

  distinct(item) %>% 

  nrow()



n_countries <- dcpo_input_raw1 %>%

  distinct(country) %>% 

  nrow()



n_years <- as.integer(summary(dcpo_input_raw1$year)[6]-summary(dcpo_input_raw1$year)[1])



total_cy <- {n_countries * n_years} %>% 

  scales::comma()



year_range <- paste("from",

                    summary(dcpo_input_raw1$year)[1],

                    "to",

                    summary(dcpo_input_raw1$year)[6])



n_cyi <- dcpo_input_raw1 %>% 

  distinct(country, year, item) %>% 

  nrow() %>% 

  scales::comma()

```



The first step towards remedying this problem is collecting the available public opinion data on gender egalitarian attitudes.

We draw on data from `r n_surveys` survey datasets, in which we identified `r n_items` distinct relevant survey items that were asked in no fewer than five country-years.

Together, these survey items were asked in `r n_countries` different countries in at least two time points over `r n_years` years, `r year_range`, yielding a total of `r n_cyi` country-year-item observations.

Considering that observations for every year in each country surveyed would number `r total_cy` and so a complete set of country-year-items would encompass `r {n_countries * n_years * n_items} %>% scales::comma()` observations, the available data is clearly very, very sparse.



```{r obs_by_item, fig.height=3, fig.cap = "Items with the Most Observations in the Source Data \\label{items_by_obs}"}

dcpo_input_raw1 %>%

  distinct(country, year, item) %>%

  count(item) %>%

  arrange(desc(n)) %>% 

  head(12) %>% 

  ggplot(aes(forcats::fct_reorder(item, n, .desc = TRUE), n)) +

  geom_bar(stat = "identity") +

  theme_bw() +

  theme(axis.title.x = element_blank(),

        axis.text.x  = element_text(angle = 90, vjust = .45, hjust = .95)) +

  ylab("Country-Years Observed")



polileader4_cy <- dcpo_input_raw1 %>% filter(item == "polileader4") %>% distinct(country, year) %>% nrow()



polileader4_surveys <- dcpo_input_raw1 %>% filter(item == "polileader4") %>% distinct(survey) %>% pull(survey)



housewifefull4_cy <- dcpo_input_raw1 %>% filter(item == "housewifefull4") %>% distinct(country, year) %>% nrow()

```



Figure&nbsp;\ref{items_by_obs} displays in how many country-years each of the twelve most-commonly asked items are available.

The `polileader4` item, which asks respondents whether they strongly agree, agree, disagree, or strongly disagree with the statement "On the whole, men make better political leaders than women do," was the most frequently asked question in the data we collected.

Employed by the Americas Barometer, the Arab Barometer, the Eurobarometer, the Latinobarì²˜metro, the Pew Research Center, and the World Values Survey, this question was asked in a total of `r polileader4_cy` different country-years.

That this constitutes only `r round(polileader4_cy*100/(n_countries * n_years))`% of the `r total_cy` total possible country-years covered---and remember, `polileader4` is the _most common_ survey item---again underscores just how sparse the available public opinion data is on this topic.



Which countries are the most data-rich?

Figure&nbsp;\ref{countries_by_obs} below shows the dozen countries with the highest count of country-year-item observations.





```{r obs_by_country, fig.cap = "Countries with the Most Observations in the Source Data \\label{countries_by_obs}"}

dcpo_input_raw1 %>%

  mutate(country = if_else(stringr::str_detect(country, "United"),

                           stringr::str_replace(country, "((.).*) ((.).*)", "\\2.\\4."),

                           country)) %>% 

  distinct(country, year, item) %>% 

  count(country) %>%

  arrange(desc(n)) %>% 

  head(12) %>% 

  ggplot(aes(forcats::fct_reorder(country, n, .desc = TRUE), n)) +

  geom_bar(stat = "identity") +

  theme_bw() +

  theme(axis.title.x = element_blank(),

        axis.text.x  = element_text(angle = 90, vjust = .45, hjust = .95)) +

  ylab("Year-Items Observed")



# uk_nas <- {1 + max(swiid_source$year) - min(swiid_source$year) - 

# {swiid_source %>% filter(country == "United Kingdom") %>% pull(year) %>% unique() %>% length()}} %>%

# wordify_numeral()

# 

# iran_obs <- swiid_source %>% filter(country == "Iran") %>% pull(year) %>% unique() %>% length()

# 

# med_cy <- swiid_source %>% count(country, year) %>% count(country, name = "nn") %>% pull(nn) %>% median() %>% wordify_numeral()

```



```{r years_by_country, fig.cap="Country-Year Coverage in the Source Data \\label{countries_by_years}"}

library(patchwork)



cby_plot <- dcpo_input_raw1 %>%

  mutate(country = if_else(stringr::str_detect(country, "United"),

                           stringr::str_replace(country, "((.).*) ((.).*)", "\\2.\\4."),

                           country),

         country = stringr::str_replace(country, "South", "S.")) %>% 

  distinct(country, year) %>%

  count(country) %>% 

  arrange(desc(n)) %>% 

  head(12) %>% 

  ggplot(aes(forcats::fct_reorder(country, n, .desc = TRUE), n)) +

  geom_bar(stat = "identity") +

  theme_bw() +

  theme(axis.title.x = element_blank(),

        axis.text.x  = element_text(angle = 90, vjust = .45, hjust = .95)) +

  ylab("Years Observed")





ybc_plot <- dcpo_input_raw1 %>%

  distinct(country, year) %>%

  count(year, name = "nn") %>%

  ggplot(aes(year, nn)) +

  geom_bar(stat = "identity") +

  theme_bw() +

  theme(axis.title.x = element_blank(),

        axis.text.x  = element_text(angle = 90, vjust = .45, hjust = .95)) +

  ylab("Countries Observed")



cby_plot + ybc_plot

```





```{r dcpo_input}

dcpo_input <- DCPOtools::format_dcpo(dcpo_input_raw1,

                                     scale_q = "polileader4",

                                     scale_cp = 2)

save(dcpo_input, file = here::here("data", "dcpo_input.rda"))

```



# Estimating Gender Egalitarianism



The DCPO model is estimated using the `DCPO` package for R [@Solt2020a], which is written in the Stan probabilistic programming language [@StanDevTeam2019a; @StanDevTeam2019b].



```{r dcpo, eval=FALSE}

iter <- 4000



dcpo_output <- dcpo(dcpo_input,

                    iter = iter,

                    chains = 4,

                    thin = iter/500, # this yields 250 draws per chain, 1000 draws total

                    pars = c("sd_delta","sd_theta_evolve", "sd_sigma_evolve", "sigma","phi","beta","alpha","delta","theta","y_r_pred","log_lik"))



save(dcpo_output, file = here::here("data", "dcpo_output.rda"))



dcpo_theta <- rstan::extract(dcpo_output, pars = "theta")



save(dcpo_theta, file = here::here("data", "dcpo_theta.rda"))



dcpo_sigma <- rstan::extract(dcpo_output, pars = "sigma")



save(dcpo_theta, file = here::here("data", "dcpo_sigma.rda"))



dcpo_y_r_pred <- rstan::extract(dcpo_output, pars = "y_r_pred")



save(dcpo_input, dcpo_y_r_pred, file = here::here("data", "dcpo_y_r_pred.rda"))

```



```{r cs_plot, fig.cap="Egalitarian Gender Attitudes, 2020 \\label{cs_2020}", fig.height=8, warning=FALSE}

load(here::here("data", "dcpo_input.rda"))

load(here::here("data", "dcpo_output.rda"))



theta_results <- DCPO::summarize_dcpo_results(dcpo_input,

                                              dcpo_output,

                                              "theta")



sigma_results <- DCPO::summarize_dcpo_results(dcpo_input,

                                              dcpo_output,

                                              "sigma")



p1_data <- theta_results %>%

    group_by(country) %>%

    top_n(1, year) %>%

    ungroup() %>%

    arrange(-mean) %>%

    mutate(half = ntile(mean, 2))



p1_data_a <- p1_data %>% filter(half==2) %>% mutate(ranked = as.factor(row_number(mean)))

p1_data_b <- p1_data %>% filter(half==1) %>% mutate(ranked = as.factor(row_number(mean)))



p1a <- ggplot(p1_data_a, aes(x = mean,

                             y = ranked)) +

    geom_segment(aes(x = `10%`, xend = `90%`,

                     y = ranked, yend = as.factor(ranked)),

                 na.rm = TRUE) +

    geom_point(fill = "black", shape = 21, size = 1.1, na.rm = TRUE) +

    theme_bw() + theme(legend.position="none",

                       axis.text.x  = element_text(size=8),

                       axis.text.y  = element_text(size=8),

                       axis.title.x = element_text(face="bold", size=8),

                       legend.text = element_text(size = 7),

                       legend.title = element_text(size=7, face = "bold"),

                       legend.key.size = unit(.5, "line"),

                       legend.background = element_rect(linetype = "solid",

                                                        color = "grey80",

                                                        size = .25),

                       legend.key = element_rect(colour = "white")) +

    scale_y_discrete(breaks = p1_data_a$ranked, labels=p1_data_a$country) +

    coord_cartesian(xlim=c(0, 1)) +

    labs(x = NULL, y = NULL)



p1b <- ggplot(p1_data_b, aes(x = mean,

                             y = ranked)) +

    geom_segment(aes(x = `10%`, xend = `90%`,

                     y = ranked, yend = ranked),

                 na.rm = TRUE) +

    geom_point(fill = "black", shape = 21, size = 1.1, na.rm = TRUE) +

    theme_bw() + theme(legend.position="none",

                       axis.text.x  = element_text(size=8),

                       axis.text.y  = element_text(size=8),

                       axis.title.x = element_text(face="bold", size=8)) +

    scale_y_discrete(breaks = p1_data_b$ranked, labels=p1_data_b$country) +

    coord_cartesian(xlim=c(0, 1)) +

    labs(x = NULL, y = NULL)



p1a + p1b



```



# Conclusion



\pagebreak
